<!DOCTYPE html>
<html>
<head>
    <title>Test WebSocket Donantes</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #messages { border: 1px solid #ccc; height: 400px; overflow-y: scroll; padding: 10px; }
        .message { margin: 5px 0; padding: 5px; background: #f0f0f0; }
        .event-donante { background: #e8f5e8; }
        .event-verificacion { background: #fff3cd; }
        .event-contacto { background: #d1ecf1; }
    </style>
</head>
<body>
    <h1>üîå Test WebSocket - Sistema de Donantes</h1>
    
    <div>
        <button onclick="connectWebSocket()">Conectar</button>
        <button onclick="disconnectWebSocket()">Desconectar</button>
        <button onclick="sendPing()">Ping</button>
        <button onclick="getStats()">Estad√≠sticas</button>
    </div>
    
    <h3>üì® Mensajes Recibidos:</h3>
    <div id="messages"></div>
    
    <script>
        let ws = null;
        const messages = document.getElementById('messages');
        
        function connectWebSocket() {
            ws = new WebSocket('ws://localhost:8001');
            
            ws.onopen = function() {
                addMessage('‚úÖ Conectado al WebSocket', 'success');
            };
            
            ws.onmessage = function(event) {
                const data = JSON.parse(event.data);
                const className = `event-${data.category || 'general'}`;
                addMessage(`üì® ${data.type}: ${JSON.stringify(data.data || data)}`, className);
            };
            
            ws.onclose = function() {
                addMessage('‚ùå Desconectado del WebSocket', 'error');
            };
            
            ws.onerror = function(error) {
                addMessage(`‚ö†Ô∏è Error: ${error}`, 'error');
            };
        }
        
        function disconnectWebSocket() {
            if (ws) {
                ws.close();
                ws = null;
            }
        }
        
        function sendPing() {
            if (ws) {
                ws.send(JSON.stringify({type: "ping"}));
            }
        }
        
        function getStats() {
            if (ws) {
                ws.send(JSON.stringify({type: "get_stats"}));
            }
        }
        
        function addMessage(message, className = '') {
            const div = document.createElement('div');
            div.className = `message ${className}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
        }
        
        // Conectar autom√°ticamente
        connectWebSocket();
    </script>
</body>
</html>